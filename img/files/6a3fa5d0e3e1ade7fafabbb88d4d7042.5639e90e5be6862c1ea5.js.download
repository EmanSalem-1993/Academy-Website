(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["6a3fa5d0e3e1ade7fafabbb88d4d7042"],{rrba:function(e,t,n){"use strict";n("pNMO");n("ma9I");n("TeQF");n("5DmW");n("NBAS");n("FZtP");Object.defineProperty(t,"__esModule",{value:true});t.default=t.TOS_MODAL_ID=void 0;var l=y(n("q1tI"));var c=a(n("TSYQ"));var i=n("mR6N");var s=a(n("wa3X"));var u=n("z8VS");var r=a(n("Pwnf"));var f=n("Uafs");var d=n("Vxy9");var o=a(n("gE8/"));var p=n("JasB");var v=n("JimW");var m=n("hCZ8");var h=n("skGw");var b=n("ohvT");function a(e){return e&&e.__esModule?e:{default:e}}function y(e){if(e&&e.__esModule){return e}else{var t={};if(e!=null){for(var n in e){if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};if(r.get||r.set){Object.defineProperty(t,n,r)}else{t[n]=e[n]}}}}t.default=e;return t}}function S(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};var r=Object.keys(n);if(typeof Object.getOwnPropertySymbols==="function"){r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))}r.forEach(function(e){P(t,e,n[e])})}return t}function g(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}function O(e,t,n){if(t)w(e.prototype,t);if(n)w(e,n);return e}function E(e,t){if(t&&(typeof t==="object"||typeof t==="function")){return t}return k(e)}function M(e){M=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)};return M(e)}function k(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function T(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});if(t)D(e,t)}function D(e,t){D=Object.setPrototypeOf||function e(t,n){t.__proto__=n;return t};return D(e,t)}function P(e,t,n){if(t in e){Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true})}else{e[t]=n}return e}var j=n("kVl0");var x=n("P7jp");var C="accept-tos-notification-modal";t.TOS_MODAL_ID=C;var F=function(e){T(o,e);function o(){var e;var a;g(this,o);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++){n[r]=arguments[r]}a=E(this,(e=M(o)).call.apply(e,[this].concat(n)));P(k(a),"state",{showModal:true,hasAccepted:false,saveStatus:"unsaved"});P(k(a),"_isMounted",false);P(k(a),"maybeShowOldModal",function(){var e=document.querySelector("#".concat(m.MODAL_PARENT_ID));if(e&&e.style.display==="none"){e.style.display="initial"}});P(k(a),"onCloseModal",function(){if(a._isMounted){a.setState({showModal:false})}a.maybeShowOldModal()});P(k(a),"handleFormKeyDown",function(e){if(e.key==="Enter"){e.preventDefault()}});P(k(a),"handleFormKeyUp",function(e){var t=a.state,n=t.saveStatus,r=t.hasAccepted;if(e.key==="Enter"){e.preventDefault();if(!r||n==="saving"){return}a.handleSave()}});P(k(a),"handleCheckboxToggle",function(e){a.setState({hasAccepted:e})});P(k(a),"handleSave",function(e){a.setState({saveStatus:"saving"});var t="/settings/accepttos";var n={};return(0,h.khanFetch)(t,S({method:"POST",headers:{"Content-Type":"application/json"}},(0,h.formUrlencode)(n))).then(a.onSuccess).catch(a.onError)});P(k(a),"onSuccess",function(){if(a._isMounted){a.setState({showModal:false})}});P(k(a),"onError",function(){x.log("Could not complete acceptance.");if(a._isMounted){a.setState({saveStatus:"failed"})}});P(k(a),"renderModalContent",function(){var e=a.props.context.isChildAccount;var t=a.state,n=t.hasAccepted,r=t.saveStatus;var o=e?b.acceptTosStrings.childCheckboxLabel:b.acceptTosStrings.notChildCheckboxLabel;return l.createElement(v.View,null,l.createElement(d.LabelMedium,null,b.acceptTosStrings.modalContent),l.createElement(v.UniqueIDProvider,{mockOnFirstRender:true,scope:"accept-tos-modal-form"},function(e){var t=e.get("checkbox");return l.createElement("form",{onKeyDown:a.handleFormKeyDown,onKeyUp:a.handleFormKeyUp,className:(0,i.css)(A.formSection)},l.createElement(u.Checkbox,{id:t,required:true,error:r==="failed",checked:n,style:A.checkbox,onChange:a.handleCheckboxToggle}),l.createElement("label",{htmlFor:t,className:"accept-terms-of-service-modal-label",dangerouslySetInnerHTML:{__html:o}}))}))});P(k(a),"renderModalFooter",function(){var e=a.state,t=e.hasAccepted,n=e.saveStatus;var r=!t||n==="saving";return l.createElement(v.View,{style:A.modalFooter},n==="failed"&&l.createElement("div",{role:"alert"},l.createElement(d.LabelSmall,{style:A.saveError},b.acceptTosStrings.saveError)),l.createElement(p.Spring,null),l.createElement(s.default,{href:"/logout",kind:"tertiary"},b.acceptTosStrings.cancelButton),l.createElement(d.Body,{style:A.orString},b.acceptTosStrings.orString),l.createElement(s.default,{onClick:a.handleSave,spinner:n==="saving",disabled:r},b.acceptTosStrings.saveButton))});P(k(a),"render",function(){if(!a.state.showModal){return null}var e=(0,c.default)("notification-bar",(0,i.css)(A.banner));return l.createElement("div",{className:e,id:C},l.createElement(f.ModalLauncher,{opened:true,backdropDismissEnabled:false,onClose:a.props.closeCallback,modal:l.createElement(f.OnePaneDialog,{title:b.acceptTosStrings.modalHeader,content:a.renderModalContent(),footer:a.renderModalFooter(),style:A.modal,closeButtonVisible:false})}))});return a}O(o,[{key:"componentDidMount",value:function e(){this._isMounted=true;j.trackSingleEvent("Show Terms of Service Dialog")}},{key:"componentWillUnmount",value:function e(){this._isMounted=false;this.maybeShowOldModal()}}]);return o}(l.Component);t.default=F;var A=i.StyleSheet.create({banner:{display:"none"},modal:{height:"auto"},formSection:{display:"flex",flexDirection:"row",marginTop:o.default.large},checkbox:{marginRight:o.default.xxSmall},modalFooter:{flexDirection:"row",alignItems:"center",width:"100%"},saveError:{color:r.default.red},orString:{margin:"0 ".concat(o.default.xSmall,"px 0 ").concat(o.default.xSmall,"px")}})}}]);
//# sourceMappingURL=../../sourcemaps/en/6a3fa5d0e3e1ade7fafabbb88d4d7042.5639e90e5be6862c1ea5.js.map